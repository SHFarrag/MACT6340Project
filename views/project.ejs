<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="content-type" content="text/html; charset=UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@100;200;300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <link rel="icon" type="image/x-icon" href="../images/favicon.ico">
    <title>NFT Site</title>
    <meta name="description" content="A personal website to showcase NFTs">
    <link rel="stylesheet" href="./css/style.css">
</head>
<body>
    <!--Page Loader Start-->
    <div class="page-loader fade-out" style="display: none;">
        <div></div>
        <div></div>
        <div></div>
    </div>
    <!--Page Loader End-->
    <div class="parallax-background">
        <div class="animated-background">
            <div class="floating-balls"></div>
        </div>
    </div>
 <!-- Header area -->
 <%- include('header'); %>
<!-- Main Content -->
<section class="main">

<!-- Portfolio Section Start -->
<section class="portfolio-section sec-padding" id="projects">
    <div class="container">
        <div class="row">
            <div class="section-title">
                <h2>Projects</h2>
            </div>
        </div>
        <!-- Conditional Rendering based on projectArray -->
        <div class="row">
            <div id="contracts" class="d-none"><%= contracts %></div>
            <div id="mints" class="d-none"><%= mints %></div>
            <div id="projects" class="d-none"><%= JSON.stringify(projects) %></div>
      
            <div class="row text-center justify-content-center">
              <div class="col-10 mb-5">
                <div class="row justify-content-center">
                  <div class="col-12 col-md-4 mt-4">
                    <div class="card m-2">
                      <img src=<%= `${project.img_url}`  %> class="card-img-top" alt="..." />
                      <div>
                        <div class="card-title">
                          <p class="h3 m-2">
                            <strong>
                              <%=project.project_name  %>
                            </strong>
                          </p>
                        </div>
                      </div>
                      <div class="card-footer">
                        <a id="mint-button" class="btn btn-primary">Mint</a>
                        <div id="project-id" class="d-none"><%= project.id %></div>
                      </div>
                    </div>
                  </div>
                  <div class="col-10 col-md-6 mt-2 text-start">
                    <p>
                    <h3 class="topic">Project name: </h3><%=project.project_name  %></p>
                    <p>
                    <h3 class="topic">Project description: </h3><%=project.project_description  %></p>
                    <div class="row">
                      <div class="col-5">
                        <h3 class="topic">Price: </h3><%= project.price_eth  %>
                      </div>
                      <div class="col-5">
                        <h3 class="topic">Quantity: </h3><%=project.quantity  %>
                      </div>
                    </div>
                    <p>
                    <h3 class="topic">Opening date: </h3><%=project.open_date_gmt  %></p>
                    <p>
                    <h3 class="topic">Royalties: </h3>The artist will get <%=project.royalty_percent  %>% of secondary sales
                    </p>
                    <p>
                    <h3 class="topic">Status: </h3><span id="status">Active - </span><span id="mint-quant"></span><span> of
                      <%=project.quantity  %> minted</span></h3>
                    </p>
                  </div>
                </div>
              </div>
              <hr class="m-2" />
            </div>
          </section>
      
          <section class="justify-content-center">
            <div class="text-center justify-content-center mt-5 mb-2">
              <h2>Mints from this project</h2>
              <p id="mint-message"></p>
            </div>
            <div class="mb-5">
              <div class="row justify-content-center">
                <div id="token-views"
                  class="row row-cols-1 row-cols-md-3 row-cols-lg-4 g-3 text-center justify-content-center">
                  <!-- the client side ejs will render these dynamically from the sript -->
                </div>
              </div>
            </div>
            </div>
        </div>
        </section>

        <div class="container-fluid">
            <%- include('footer'); %>
          </div>
          <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
          <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.4/dist/umd/popper.min.js"></script>
          <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
          <script type="module" src="./js/index.js"></script>
          <script type="module" src="https://unpkg.com/@splinetool/viewer@1.6.8/build/spline-viewer.js"></script>
          <script>
              document.querySelector('.menu-toggle').addEventListener('click', () => {
                  document.querySelector('.menu').classList.toggle('active');
              });
      
              // Creating bg balls
              const container = document.querySelector('.floating-balls');
              for (let i = 0; i < 20; i++) {
                  const ball = document.createElement('div');
                  ball.classList.add('ball');
                  container.appendChild(ball);
      
                  // Randomizing positions and animation duration
                  ball.style.left = `${Math.random() * 100}vw`;
                  ball.style.top = `${Math.random() * 100}vh`;
                  ball.style.animationDuration = `${5 + Math.random() * 10}s`;
                  ball.style.animationDelay = `${Math.random() * 5}s`;
              }
          </script>
         <script>
      document.getElementById("contact-form").addEventListener("submit", async function(event) {
          event.preventDefault(); // Prevent the default form submission
      
          const form = event.target;
          const formData = new FormData(form);
      
          const formObj = Object.fromEntries(formData.entries());
      
          try {
              const response = await fetch("/mail", {
                  method: "POST",
                  headers: {
                      "Content-Type": "application/json"
                  },
                  body: JSON.stringify(formObj)
              });
      
              if (response.ok) {
                  alert("Message sent successfully!");
              } else {
                  const errorText = await response.text();
                  alert("Failed to send message: " + errorText);
              }
          } catch (error) {
              console.error("Error sending message:", error);
              alert("Failed to send message: " + error.message);
          }
      });
      </script>
      
      </body>
      </html>
